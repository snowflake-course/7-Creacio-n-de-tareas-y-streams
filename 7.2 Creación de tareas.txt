// Crear BBDD transient
CREATE OR REPLACE TRANSIENT DATABASE TASK_DB;
USE TASK_DB


// Preparar tabla
CREATE OR REPLACE TABLE CUSTOMERS (
    CUSTOMER_ID INT AUTOINCREMENT START = 1 INCREMENT =1,
    FIRST_NAME VARCHAR(40) DEFAULT 'Iván' ,
    CREATE_DATE DATE)
    
    
// Create Tarea
CREATE OR REPLACE TASK CUSTOMER_INSERT
    WAREHOUSE = COMPUTE_WH
    SCHEDULE = '1 MINUTE' // Programar siempre en minutos
    AS 
    INSERT INTO CUSTOMERS(CREATE_DATE) VALUES(CURRENT_TIMESTAMP); //Podría ser un COPY INTO 
    
// Mostrar tareas
SHOW TASKS;

// Empezar la tarea y suspenderla
ALTER TASK CUSTOMER_INSERT RESUME;
ALTER TASK CUSTOMER_INSERT SUSPEND;

// Verificar resultados
SELECT * FROM CUSTOMERS